<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>
		<template id="sd_inherit_report_saleorder" inherit_id="sale.report_saleorder_document">
						
			<xpath expr="//div/div[@class='row']" position="replace"/>

			<xpath expr="//div/h2" position="attributes">
				<attribute name="style">font-size:16px;margin-left:40%</attribute>
			</xpath>
			
			<xpath expr="//div/h2" position="after">
				<t t-set="DESCUENTO" t-value="0" />
				<t t-foreach="o.order_line" t-as="l">
					<t t-if="l.discount > 0">
						<t t-set="DESCUENTO" t-value="1" />
					</t>
				</t>
				<div style="font-size:12px">
					<div t-if="o.partner_id.name">
						<strong>Fiscal name: </strong>
						<span t-field="o.partner_id.name"/>
					</div>
					<div t-if="o.partner_id.comercial">
						<strong>Comercial name: </strong>
						<span t-field="o.partner_id.comercial"/>
					</div>
					<div t-if="o.partner_id.vat">
						<strong>NIF: </strong>
						<span t-field="o.partner_id.vat"/>
					</div>
                    <div t-if="o.partner_id.street">
                    	<strong>Address: </strong> 
                    	<span t-if="o.partner_id.street" t-esc="'%s, ' % o.partner_id.street"/>
                    	<span t-if="o.partner_id.zip" t-esc="'CP: %s, ' % o.partner_id.zip"/>
                    	<span t-if="o.partner_id.city" t-esc="'%s, ' % o.partner_id.city"/>
                    	<span t-if="o.partner_id.country_id" t-esc="'%s' % o.partner_id.country_id.name"/>
                    </div>
				</div>
			</xpath>
			
			<xpath expr="//div/div[@class='row mt32 mb32']" position="attributes">
				<attribute name="style">font-size:13px</attribute>
			</xpath>
			
			<xpath expr="//div/table[@class='table table-condensed']" position="attributes">
				<attribute name="style">font-size:13px</attribute>
			</xpath>
			
			<xpath expr="//div/div[@class='row']" position="attributes">
				<attribute name="style">font-size:13px</attribute>
			</xpath>
			
			<xpath expr="//div/p[@t-field='o.note']" position="attributes">
				<attribute name="style">font-size:13px</attribute>
			</xpath>
			
			<xpath expr="//div/p[@t-if='o.payment_term.note']" position="attributes">
				<attribute name="style">font-size:13px</attribute>
			</xpath>
<!--             <xpath expr="//div/p[@t-field='o.note']" position="before">
                <p style="page-break-after:always;"></p>Salto de pagina 
            </xpath>
 -->			
			<xpath expr="//div/div/div[@t-if='o.payment_term']" position="replace"/>
			<xpath expr="//tr/th[@groups='sale.group_discount_per_so_line']" position="replace">
				<t t-if="DESCUENTO">
					<th groups="sale.group_discount_per_so_line">Disc.(%)</th>
	            </t>
			</xpath>
			<xpath expr="//tr[@t-foreach='o.order_line']" position="replace">
				<tr t-foreach="o.order_line" t-as="l">
					<td>
						<span t-field="l.name" />
					</td>
					<td>
						<t t-if="l.product_uom_qty">
							<span t-esc="', '.join(map(lambda x: x.name, l.tax_id))" />
						</t>
					</td>
					<td class="text-right">
						<t t-if="l.product_uom_qty">
							<span t-field="l.product_uom_qty" />
							<span groups="product.group_uom" t-field="l.product_uom" />
						</t>
					</td>
					<td class="text-right">
						<t t-if="l.product_uom_qty">
							<span t-field="l.price_unit" />
						</t>
					</td>
					<t t-if="DESCUENTO">
						<td groups="sale.group_discount_per_so_line">
							<t t-if="l.product_uom_qty">
								<span t-field="l.discount" />%
							</t>
						</td>
					</t>
					<td class="text-right">
						<t t-if="l.product_uom_qty">
						<span t-field="l.price_subtotal"
							t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.pricelist_id.currency_id&quot;}" />
						</t>
					</td>
				</tr>
			</xpath>
			<!-- <xpath expr="//tr[@t-foreach='o.order_line']/td[@groups='sale.group_discount_per_so_line']" position="before">			
				<t t-if="DESCUENTO">
					<td groups="sale.group_discount_per_so_line">
						<t t-if="l.product_uom_qty">
							<span t-field="l.discount" />%
						</t>
					</td>
				</t>			
			</xpath>
			<xpath expr="//tr[@t-foreach='o.order_line']/td[@groups='sale.group_discount_per_so_line']" position="replace"/> -->
			<xpath expr="//div[@id='informations']" position="replace"/>
		</template>
		
		<record id="sd_inherit_report_saleorder" model="ir.ui.view">
			<field name="priority">20</field>
		</record>
		
	</data>
</openerp>
